#On computer, rearrange counts.tsv file to countstable.txt followed by copying it to thinlinc
scp /Users/priyankamukherjee/Desktop/countstable_338vs412.txt primukh@carbonate.uits.iu.edu:/N/slate/primukh/FLAGRIPSeq/Raw_data/Unzipped_files/Results_FLAGRIP/RIPSEq_Analysis

#Copy experiment.txt from desktop to server
scp /Users/priyankamukherjee/Desktop/experiment.txt primukh@carbonate.uits.iu.edu:/N/slate/primukh/FLAGRIPSeq/Raw_data/Unzipped_files/Results_FLAGRIP/RIPSEq_Analysis

#Open R_Version 4.1.1

library(DESeq2)
#Version 1.34.0

library("gplots")
library("RColorBrewer")
library("genefilter")
library("IHW")
library("pheatmap")
library("ggplot2")

countsTable <- read.table("/N/slate/primukh/FLAGRIPSeq/Raw_data/Unzipped_files/Results_FLAGRIP/RIPSEq_Analysis/countstable_338vs412.txt", header = TRUE, row.names = 1)
experimentData <- read.table("/N/slate/primukh/FLAGRIPSeq/Raw_data/Unzipped_files/Results_FLAGRIP/RIPSEq_Analysis/experiment.txt", header=TRUE)
rownames(experimentData) <- experimentData$sample

dds <- DESeqDataSetFromMatrix(countData = countsTable, colData = experimentData, design = ~ assay + condition + condition:replicate + condition:assay)


#DESeq2 would define the ratios based on the order of levels of the factors defining the condition which by default follow the alphabetical order  (ADAR3 and Ctrl). 
#The first level would be considered denominator. Hence the default fold change was defined as Ctrl / ADAR3. 
#This can be fixed by redefining the order of the levels as below, bringing Ctrl as the top level.

dds$condition <- factor(dds$condition, levels=c("Ctrl","ADAR3"))  

dds <- DESeq(dds, test="LRT", reduced = ~ 1)

res_LRT <- results(dds, test="LRT")

